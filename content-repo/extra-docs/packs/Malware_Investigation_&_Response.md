---
id: malware-investigation-and-response
title: Malware Investigation and Response
description: The  Malware Investigation and Response content pack provides a framework for handling malware investigations.
---

Malware threat is one of the most common cybersecurity challenges facing businesses today. It causes data breaches, hardware failures, and inoperable computers and system networks that can be extremely costly to recover.  
Malware investigations require security teams to reconcile data from multiple security products like EDRs, sandboxes, malware analysis tools, and threat intelligence providers. 
Performing investigations manually wastes valuable time when malware may be propagating within an organization.

The Malware Investigation & Response content pack accelerates the investigation process for endpoint malware incidents and alerts by collecting evidence of malicious behaviors from telemetry data available through EDRs and processing malware analysis reports through sandboxes. Incident layouts also include buttons to remediate activities quickly.    
The pack closely maps evidence to MITRE ATT&CK to uncover evidence of:
- Persistence (for example, registry and scheduled jobs)
- Evasion or tampering (for example and service stop and process kill)
- Lateral movement (for example, network connections and file share enumeration)
- Powershell abuse and command-line analysis
- Digitally signed files

## What Does This Pack Do?
* Provides forensic data, including running processes and open network connections at alert detection time
* Retrieves files and detonates sandboxes
* Processes select sandbox reports and visualizes the results in layouts
* Extracts indicators and provides threat intelligence enrichment
* Tags malicious and benign indicators for allow and deny lists for threat prevention and false-positive management
* Mirrors incidents between the EDR and Cortex XSOAR and enables incident closure with the EDR
* Supports aggregating incidents from EDRs, including multiple alerts and files

## Pack Configuration
This pack leverages the new Deployment Wizard capability to streamline deployment and configuration (Available from Cortex XSOAR 6.8).  
- Primary playbook: Malware Investigation and Response Incident Handler
- Primary incident type: Malware Investigation and Response

## Dependencies
* EDRs
    * CrowdStrike Falcon
    * Cortex XDR
    * Microsoft Defender for Endpoint
* Deep sandbox
    * Palo Alto WildFire
    * CrowdStrike Falcon X
* Standard sandbox (detonation only), including:
    * Palo Alto WildFire
    * Joe Sandbox
    * Lastline
    * Cuckoo
    * Hybrid Analysis
* Malware Core
* Threat Intelligence 

## Layouts

This layout has three tabs:
* [Incident info tab](#incident-info-tab)
* [Investigation tab](#investigation-tab)
* [Forensics](#forensics-tab)


 
## Integrations / Platforms
## Endpoint Integrations
### Cortex XDR
Required Information to be set before starting:
* Main Playbook - Cortex XDR Malware - Investigation and Response
* Classifier - Cortex XDR Incident Handler - Classifier 



## Feature Summary

| **Section**                  | **Feature**                         | **Microsoft Defender For Endpoint** | **CrowdStrike Falcon**      | **Cortex XDR**              |
|------------------------------|-------------------------------------|-------------------------------------|-----------------------------|-------------------------------|
| Playbook -  Advanced Hunting | Information located in Evidence tab |                   V                 |               X                       |               V                         |
| Layout                       | **Kill Process** button             |                   X                 | V  <br/>(Only with the file path ) |  V <br/> (Only with the file name) |
| Layout                       | Delete file                         |                   V                 |               V                        |               V                        |
| Layout                       | Isolate / unisolate  endpoint       |                   V                 |               V                        |               V                        |
| Layout                       | Evidence - process list             |                   X                 |               V                        |               V                        |
| Layout                       | Evidence - netstat information      |                   X                 |               V                        |               X                        |

## Getting Started / How to set up the pack
For better user experience and easier onboarding for your use case, use the **Deployment Wizard** after installing the content pack on the Marketplace page in Cortex XSOAR (Available for version 6.8).


## Pack Disclaimers
1. The current layout shows only one item being searched (for example, one endpoint or one file SHA256) even though the logic is running and analyzing all the relevant information and performing enrichment on all the items.
2. Each vendor uses unique features and exposed API calls, so some of the layout features work only for certain vendors. See the **Feature Summary** above.
3. Some actions are irreversible. For example, the analyst should be careful when deleting files since deleting a file cannot be reversed (do not delete explorer.exe from the investigated device).
4. The logic supports **only** Microsoft Windows OS platforms. However, certain parts of the playbooks can analyze and provide information on other operating systems. For example, the sandbox section can run on Linux, Mac, Android, and others.
5. Avoid using the **Close** option before testing, since there are issues in deduplication logic when closing incidents that have not been opened yet.

 
