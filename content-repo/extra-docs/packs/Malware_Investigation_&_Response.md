---
id: malware-investigation-and-response
title: Malware Investigation and Response
description: The  Malware Investigation and Response content pack provides a framework for handling malware investigations.
---

Malware threat is one of the most common cybersecurity challenges facing businesses today. It causes data breaches, hardware failures, and inoperable computers and system networks that can be extremely costly to recover.  
Malware investigations require security teams to reconcile data from multiple security products like EDRs, sandboxes, malware analysis tools, and threat intelligence providers. 
Performing investigations manually wastes valuable time when malware may be propagating within an organization.

The Malware Investigation & Response content pack accelerates the investigation process for endpoint malware incidents and alerts by collecting evidence of malicious behaviors from telemetry data available through EDRs and processing malware analysis reports through sandboxes. Incident layouts also include buttons to remediate activities quickly.    
The pack closely maps evidence to MITRE ATT&CK to uncover evidence of:
- Persistence (for example, registry and scheduled jobs)
- Evasion or tampering (for example and service stop and process kill)
- Lateral movement (for example, network connections and file share enumeration)
- Powershell abuse and command-line analysis
- Digitally signed files

## What Does This Pack Do?
- Provides forensic data, including running processes and open network connections at alert detection time
- Retrieves files and detonates sandboxes
- Processes select sandbox reports and visualizes the results in layouts
- Extracts indicators and provides threat intelligence enrichment
- Tags malicious and benign indicators for allow and deny lists for threat prevention and false-positive management
- Mirrors incidents between the EDR and Cortex XSOAR and enables incident closure with the EDR
- Supports aggregating incidents from EDRs, including multiple alerts and files

## Pack Configuration
This pack leverages the new Deployment Wizard capability to streamline deployment and configuration (Available from Cortex XSOAR 6.8).  
- Primary playbook: Malware Investigation and Response Incident Handler
- Primary incident type: Malware Investigation and Response

## Dependencies
- EDRs
    - CrowdStrike Falcon
    - Cortex XDR
    - Microsoft Defender for Endpoint
- Deep sandbox
    - Palo Alto WildFire
    - CrowdStrike Falcon X
- Standard sandbox (detonation only), including:
    - Palo Alto WildFire
    - Joe Sandbox
    - Lastline
    - Cuckoo
    - Hybrid Analysis
- Malware Core
- Threat Intelligence 

## Layouts

This layout has three tabs:
- [Incident info tab](#incident-info-tab)
- [Investigation tab](#investigation-tab)
- [Forensics](#forensics-tab)


 
## Integrations / Platforms
## Endpoint Integrations
### Cortex XDR
Required Information to be set before starting:
- Main Playbook - 'Cortex XDR Malware - Investigation and Response'
- Classifier - 'Cortex XDR Incident Handler - Classifier' 



## Features summarize

| **Section**                  | **Feature**                         | **_Microsoft Defender For Endpoint_** | **_CrowdStrike Falcon_**      | **_Cortex XDR_**              |
|------------------------------|-------------------------------------|---------------------------------------|-------------------------------|-------------------------------|
| Playbook -  Advanced Hunting | Information located in Evidence tab |                   V                   |               X               |               V               |
| Layout                       | 'Kill Process' button               |                   X                   | V  (only with the file path ) | V  (only with the file name ) |
| Layout                       | Delete File                         |                   V                   |               V               |               V               |
| Layout                       | Isolate / Unisolate  Endpoint       |                   V                   |               V               |               V               |
| Layout                       | Evidence - Process List             |                   X                   |               V               |               V               |
| Layout                       | Evidence - Netstat information      |                   X                   |               V               |               X               |
|                              |                                     |                                       |                               |                               |
|                              |                                     |                                       |                               |                               |
|                              |                                     |                                       |                               |                               |
|                              |                                     |                                       |                               |                               |

## Testing the Pack
For better user experience and easy onboarding for the usecase, please use the 'Deployment Wizard' located on the Marketplace page in Cortex XDOAR ( will appear only for version 6.8 and once you have installed the pack).


## Pack Disclaimers
1. The current layout is showing only 1 item being searched on ( like 1 endpoint or 1 file sha256), however the most of the logic
is actually going and analyzing all the relevant information and enriching this as much as possible.
2. As each vendor is individual and unique with his features and exposed API calls - Part of the layout features are working only on certain vendors. Please read the documentation above.
3. Some actions are undo-able. For example, deleting a file is a harmful operation, hence the Analyst should be aware of the taken action ( and not deleting explorer.exe from investigated device).
4. The logic here was built to support **only** Microsoft Windows OS platforms, however, certain parts of the playbooks can analyze and provide infomration on other different OS (E.g. The Sandbox section can be run on Linux / Mac / Andorid / etc)
5. Dedup logic can be very problamatic when it comes to closing incidents that have not been open yet. Please avoid using the Close option before testing.

 