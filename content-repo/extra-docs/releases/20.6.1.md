# Cortex XSOAR Content Release Notes for version 20.6.1 (59290)
##### Published on 21 June 2020
### Integrations

####  6 New Integrations
- __Group-IB TDS Polygon__  
TDS Polygon is a Malware Detonation & Research platform designed for deep dynamic analysis and enhanced indicators extraction. TDS Polygon analyzes submitted files and urls and extracts deep IOCs that appear when malicious code is triggered and executed. Polygon could be used either for application-level tasks (like smtp-based mail filtering) and analytical purposes (files/urls analysis for verdict, report and indicators).
- __Infocyte__  
Infocyte can pivot off incidents to automate triage, validate events with forensic data and enabling dynamic response actions against any or all host using both agentless or agented endpoint access.
- __Deep Instinct__  
Deep Instinct.
- __BigFix__  
IBM BigFix Patch provides an automated, simplified patching process that is administered from a single console.
- __Zoom Feed__  
Use the Zoom Feed integration to get indicators from the feed.
- __EWS O365__  
Exchange Web Services and Office 365 (mail).

####  31 Improved Integrations
- __FireEye Helix__  
  - ## Unreleased.
  - Fixed an issue in the ***fireeye-helix-search*** command where the *headers* argument was not processed as expected.
  - ## [19.11.1] - 2019-11-26.
  - New Integration FireEye Helix. FireEye Helix is a security operations platform. FireEye Helix integrates security tools and augments them with next-generation SIEM, orchestration and threat intelligence tools such as alert management, search, analysis, investigations and reporting.
- __Prisma Cloud (RedLock)__  
Added support for multi-environment instances.
- __Palo Alto Networks PAN-OS__  
- POST request parameterss are now passed through body and not through the URI.
- __ServiceNow v2__  
Fixed an issue in which the **ServiceNow ticket column to be set as the incident name** parameter was not initialized with the default value as expected.
- __Securonix__  
  - Added the *max* parameter to the *securonix-list-incidents* command.
  - Added the *max_fetch* parameter to the integration configuration, where the default and maximum value is 50.
  - Fixed an issue where duplicate incidents where fetched.
- __Mimecast v2__  
Fixed parsing of responses for the ***create-mimecast-incident*** command.
- __Red Canary__  
  - Removed timeline details for a detection fetched as an incident.
  - Fixed an issue in which acknowledged detections were fetched as incidents.
- __VirusTotal__  
  - Fixed an issue where urls with a comma were parsed incorrectly.
  - Fixed an issue where the **url** command lacked the default url argument.
- __Carbon Black Enterprise Protection v2__  
Added documentation notes.
- __HelloWorld__  
  - Changed category to Utilities.
  - Improved the **fetch-incidents** command to prevent duplicate incidents.
- __JSON Feed__  
Fixed an issue where the integration failed to fetch indicators from lists within JSON objects.
- __Cortex Data Lake__  
Fixed a bug in the ***cdl-query-logs*** when no records are found for a given query.
- __Prisma Cloud (RedLock)__  
Added support for multi-environment instances.
- __EWS v2__  
- Fixed a bug in the **test module** which failed on a delegated mailbox.
- __FortiSIEM__  
  - Fixed an issue where the authentication did not work properly.
  - Fixed an issue where the ***fortisiem-get-events-by-incident*** command did not return results.
- __Carbon Black Enterprise Response v2__  
  - Added new context outputs for the ***cb-get-processes*** command:.
  - **File.Name**.
  - **File.MD5**.
  - **File.Path**.
  - **Endpoint.Hostname**.
- __Cisco Threat Grid__  
Fixed a bug in **threat-grid-get-analysis-by-id** command which failed on a syntax error.
- __Proofpoint Protection Server (Beta)__  
Improved parsing of response returned from Proofpoint.
- __Cofense Triage - Deprecated__  
Deprecated - We recommend using Cofense Triage v2 instead (available from 5.0.0).
- __JsonWhoIs__  
Prints an error when an error is returned from the API.
- __Joe Security__  
- Fixed a bug in **joe-analysis-info** command that wasn't returning a DBotScore.Indicator when was given a URL.
- __Recorded Future RiskList Feed__  
Improved parsing of IOC objects.
- __Cofense Feed__  
Removed the threat type **phish**.
- __Palo Alto Networks BPA__  
Added the *exclude_passed_checks* argument to the ***pan-os-bpa-get-job-results*** command, which gives the option to exclude passed checks.
- __Check Point Firewall__  
Added the **command** argument to the ***checkpoint*** command. This argument is the command to run in the firewall.
- __RTIR__  
  - Fixed an issue where the ***fetch-incidents*** and ***search-tickets*** commands did not behave as expected.
  - Fixed an issue where the test module did not work as expected.
  - Added the *Fetch limit* parameter to the instance configuration, which specifies the maximum number of results to fetch.
  - Added the *results_limit* argument to the ***search-tickets*** command, which specifies the maximum number of results to return.
  - Improved parsing of ticket history and ticket links.
- __Slack v2__  
  - Added details about direct messages and changing the app name in the README file.
- __FireEye ETP__  
Improved empty response handling.
- __Palo Alto Networks Cortex XDR - Investigation and Response__  
  - Added 6 commands.
    - ***xdr-blacklist-files***
    - ***xdr-whitelist-files***
    - ***xdr-quarantine-files***
    - ***xdr-get-quarantine-status***
    - ***xdr-restore-file***
    - ***xdr-endpoint-scan***
  - Added get-quarantine-file-status playbook.
  - Fixed a bug in the ***xdr-get-endpoint*** command where only the last endpoint was displayed in context.
- __Microsoft Defender Advanced Threat Protection__  
Added support to authenticate using a self-deployed Azure application.
- __Microsoft Teams__  
Improved error handling.

---
### Scripts

####  5 New Scripts
- __GetShiftsPerUser__  
Retrieves the number of on-call hours per user.
- __PcapMinerV2__  
  - PcapMIner V2 allows to parse PCAP files by displaying the all of the relevant data within including ip addresses, ports, flows, specific protocol breakdown, searching by regex, decrypting encrypted  traffic and more.
  - This automation takes about a minute to process 20,000 packets (which is approximately 10MB). If you want to mine large files you can either:.
  - a) Use the *pcap_filter* parameter to filter your PCAP file and thus make is smaller.
  - b) Copy the automation and change the *default timeout* parameter to match your needs.
- __TimeStampCompare__  
Compares a single timestamp to a list of timestamps.
- __DateStringToISOFormat__  
This is a thin wrapper around the *dateutil.parser.parse* function. It will parse a string containing a date/time stamp and return it in ISO 8601 format.
- __DBotMLFetchData__  
Collect telemetry data from the environment.

####  6 Improved Scripts
- __HTTPFeedApiModule__  
Added support for auto detection of indicator types.
- __CSVFeedApiModule__  
Added support for auto detection of indicator types.
- __HelloWorldScript__  
 - Minor grammar fixes.
- __CommonServerPython__  
  - Added **Endpoint** Common class.
  - Added a new function **auto_detect_indicator_type** which detects indicators. 
  - Fixed an issue where the **argToList** function did not behave as expected. This fix is breaking backward compatibility.
- __JSONFeedApiModule__  
## [Unreleased].
- __GetOnCallHoursPerUser__  
Fixed error handling of the getUsers call.

---
### Playbooks

####  24 New Playbooks
- __Prisma Access - Connection Health Check__  
Use the Prisma Access integration to run SSH CLI commands and query the connection states for all tunnels. If any tunnels are down - the playbook escalates to a manual task for remediation and provides recommendations on next steps in the task description. The playbook can be run as a job, or triggered from an incoming event to confirm an initial suspicion (such as a tunnel log from Cortex Data Lake) to validate that the issue still exists.
- __Cortex XDR - Malware Investigation__  
  - Investigates a Cortex XDR incident containing internal malware alerts. The playbook:.
  - Enriches the infected endpoint details.
  - Lets the analyst manually retrieve the malicious file.
  - Performs file detonation.
  - The playbook is used as a sub- playbook in ‘Cortex XDR Incident Handling - v2’.
- __Search Endpoints By Hash - Carbon Black Response V2__  
Hunt for malicious indicators using Carbon Black.
- __Cortex XDR Alerts Handling__  
  - This playbook is used to loop over every alert in a Cortex XDR incident.
  - Supported alert categories:.
  - Malware.
  - Port Scan.
- __Detonate URL - Group-IB TDS Polygon__  
Detonate URL using Group-IB TDS Polygon integration.
- __Malware Investigation - Manual__  
  - Master playbook for investigating suspected malware presence on an endpoint.
  - Labels:.
  - System: the hostname for the endpoint being investigated.
- __McAfee ePO Repository Compliance Playbook v2__  
Ensures that ePO servers are updated to the latest McAfee published AV signatures (DAT file version).
- __Detonate File - Group-IB TDS Polygon__  
Detonate file using Group-IB TDS Polygon integration. This playbook returns relevant reports to the War Room and file reputations to the context data. The detonation supports the following file types: 7z, ace, ar, arj, bat, bz2, cab, chm, cmd, com, cpgz, cpl, csv, dat, doc, docm, docx, dot, dotm, dotx, eml, exe, gz, gzip, hta, htm, html, iqy, iso, jar, js, jse, lnk, lz, lzma, lzo,  lzh, mcl, mht, msg, msi, msp, odp, ods, odt, ots, ott, pdf, pif, potm, potx, pps, ppsm, ppsx, ppt, pptm, pptx, ps1, pub, py, pyc, r*, rar, reg, rtf, scr, settingcontent-ms, stc, svg, sxc, sxw, tar, taz,  .tb2, .tbz, .tbz2, tgz, tlz, txz, tzo, txt, url, uue, vbe, vbs, wsf, xar, xls, xlsb, xlsm, xlsx, xml, xz, z*, zip.
- __TIM - Process Domain Registrant With Whois__  
This playbook compares the domain registrant against the Cortex XSOAR list of approved registrants provided in the inputs. A registrant is the company or entity that owns the domain.
- __HIPAA - Breach Notification__  
  - USA Health Insurance Portability and Accountability Act of 1996 (HIPAA) covers organizations that use, store, or process Private Health Information (PHI).
  - The HIPAA Breach Notification Rule requires companies that deal with health information to disclose cybersecurity breaches; the disclosure will include notification to individuals, to the media, and the Secretary of Health and Human Services.
  - This playbook is triggered by a HIPAA breach notification incident and follows through with the notification procedures.
  - DISCLAIMER: Please consult with your legal team before implementing this playbook.
  - ** Source: https://www.hhs.gov/hipaa/for-professionals/breach-notification/index.html.
- __Hunt Extracted Hashes V2__  
  - This playbook extracts IOCs from the incident details and attached files using regular expressions and then hunts for hashes on endpoints in the organization using available tools.
  - The playbook supports multiple types of attachments. For the full supported attachments list, refer to "Extract Indicators From File - Generic v2".
- __Cortex XDR incident handling v2__  
  - This playbook is triggered by fetching a Palo Alto Networks Cortex XDR incident.
  - The playbook syncs and updates new XDR alerts that construct the incident and triggers a sub-playbook to handle each alert by type.
  - Then, the playbook performs enrichment on the incident's indicators and hunting for related IOCs.
  - Based on the severity, it lets the analyst decide whether to continue to the remediation stage or close the investigation as a false positive.
  - After the remediation, if there are no new alerts, the playbook stops the alert sync and closes the XDR incident and investigation.
- __Cortex XDR - quarantine file__  

- __Allow IP - Okta Zone__  
  - Sync a list of IP addresses to the Okta Network Zone with the given ID.
  - Existing IPs in the Okta Zone which are not in the input list will be removed and the indicator will be untagged in Cortex XSOAR.
  - IDs can be retrieved  using !okta-list-zones. This playbook supports CIDR notation only (1.1.1.1/32) and not range notation (1.1.1.1-1.1.1.1).
- __CrowdStrike Rapid IOC Hunting v2__  
Hunt for endpoint activity involving hash and domain IOCs using Crowdstrike Falcon Host.\nAlso use AnalystEmail label to determine where to send an email alert if something is found.
- __Search Endpoints By Hash - Generic V2__  
Hunt using available tools.
- __Entity Enrichment - Generic v3__  
Enrich entities using one or more integrations.
- __Cortex XDR - Port Scan - Adjusted__  
  - Investigates a Cortex XDR incident containing internal port scan alerts. The playbook:.
  - Syncs data with Cortex XDR.
  - Notifies management about a compromised host.
  - Escalates the incident in case of lateral movement alert detection.
  - The playbook is used as a sub- playbook in 'Cortex XDR Incident Handling - v2'.
- __McAfee ePO Endpoint Connectivity Diagnostics Playbook v2__  
Perform a check on ePO endpoints to see if any endpoints are unmanaged or lost connectivity with ePO and take steps to return to a valid state.
- __Enrich McAfee DXL using 3rd party sandbox v2__  
  - Example of bridging DXL to a third party sandbox.
  - Detonate a file in 3rd party sandbox and if malicious, push its MD5, SHA1 and SHA256 hashes to McAfee DXL.
- __Enrich DXL with ATD verdict v2__  
  - Uses McAfee ATD to push any malicious verdicts over DXL.
  - Detonates a file in ATD and if malicious, pushes its MD5, SHA1 and SHA256 hashes to McAfee DXL.
- __TIM - Process Domains With Whois__  
This playbook uses several sub playbooks to process and tag indicators based on the results of the Whois tool.
- __TIM - Process Domain Age With Whois__  
This playbook compares the domain creation time against a provided time value such as one month ago. The period can be configured within the playbook inputs MinimumAgeOfDomainMonths or MinimumAgeOfDomainHours. The playbook calculates the timestamp for the relevant period and compares it to the domain creation time value provided by Whois. The domains are outputted accordingly if they were created before or after the compared time, respectively.
- __McAfee ePO Endpoint Compliance Playbook v2__  
Discover endpoints that are not using the latest McAfee AV Signatures.

####  12 Improved Playbooks
- __Process Email - Generic__  
  - Added a check that verifies whether the Rasterize integration is enabled before attempting to rasterize HTML-formatted emails.
  - Simplified the flow of the playbook by merging tasks where possible and renaming tasks to better reflect their purpose.
  - Email headers will now show in phishing incident layouts.
- __PAN-OS DAG Configuration__  
- Removed transformers that were no longer needed.
- __Search Endpoints By Hash - Generic__  
- Deprecated. Use the Search Endpoints By Hash - Generic V2 playbook instead.
- __PAN-OS - Create Or Edit Rule__  
- Removed transformers that were no longer needed.
- __Phishing - Core__  
  - Fixed an issue where URL screenshots did not show in the layout.
  - Merged 2 conditions into 1 to clean up playbook.
- __Process Email - Core__  
  - Added checks to verify that the Rasterize integration is enabled before attempting to rasterize HTML-formatted emails, and before taking URL screenshots.
  - Email headers will now show in phishing incident layouts.
- __Get Original Email - EWS__  
Added the email headersmap output. This change allows phishing incidents to display email headers if the original email was retrieved.
- __TIM - Indicator Auto Processing__  
Added Whois sub playbook.
- __Hunt Extracted Hashes__  
- Deprecated. Use the Hunt Extracted Hashes V2 instead.
- __Search Endpoints By Hash - Carbon Black Response__  
- Deprecated. Use the Search Search Endpoints By Hash - Carbon Black Response V2 instead.
- __Get Original Email - Generic__  
Added an output of email headers.
- __Access Investigation - Generic__  
Starting with Demisto 4.5, this playbook uses newer versions of previously used playbooks.

---
### Incident Fields
- __Media Notification__  
The status of the media notification.
- __Event Type__  
Event Type.
- __Destination Hostname__  
Destination hostname.
- __Tenant Name__  
Tenant Name.
- __Log Source__  
Log Source.
- __Destination Port__  
The destination port used.
- __OS__  
The operating system.
- __Source Port__  
The source port that was used.
- __Protocol__  
Protocol.
- __Event ID__  
Event ID.
Associated the Source Hostname field to all incident types.
Associated the field with the Port Scan incident type.
  - Associated the field with the Port Scan incident type.
  - Associated the File Hash field to the Cortex XDR Port Scan incident type.
  - Associated the field with the Port Scan incident type.
  - Associated the Destination IP field to the Cortex XDR Port Scan incident type.
  - Associated the field with the Port Scan incident type.
  - Associated the Source IP field to the Cortex XDR Port Scan incident type.
Added the Agent ID field to all incident types.
Associated the field with the Port Scan incident type.
Added the Source Username field to all incident types.

---
### Layouts

####  2 New Layouts
- __HIPAA Breach Notification - New/Edit__  

- __HIPAA Breach Notification - Summary__  


####  Improved Layouts
- __Phishing - Summary__  
The phishing layout now displays the email headers if the email was attached as file or was retrieved using mail listener integrations.